% Add:
%%%
% New symbols for quality assignments
%%%
% platform properties
\TUchapter{Discrete Extensions}
\TUsection{Introduction}
For various reasons, the adaptation of the attack graph formalism described in
the preceding chapter for hybrid purposes depends upon the addition of a number
of entirely discrete elements. Their inclusion produces a transitional
attack graph formalism that is not yet appropriate for hybrid modeling but that
contains a number of enhancements suitable for discrete system modeling.

This chapter introduces these enhancements, which include a working lexicon of
standard terms for topologies and qualities based upon the Common Vulnerability
Enumeration and National Vulnerability Database; some syntactic
changes to ease the modeling of information systems; a scheme for integrating with
the Common Platform Enumeration; and some state predicate analysis tools.

\TUsection{Working Lexicon}
\TUsubsection{Introduction}
Because of the unrestricted nature of the terms available to a modeler
in this version of the attack graph framework, in order to proceed systematically
some conventions must be established in the use of terms. This thesis recommends
a set of conventions designed to ease the goal of automated exploit pattern extraction
from the National Vulnerability Database (NVD) maintained by the 
National Institute of Standards and Technology (NIST), which among other roles
indexes MITRE's Common Vulnerability Enumeration (CVE). ``NVD includes 
databases of security checklists, security related software flaws, 
misconfigurations, product names, and impact metrics''~\cite{nvdhome}.
\TUsubsection{National Vulnerability Database}
Several concepts are used across the NVD's index of vulnerabilities; they
strongly inform the working lexicon employed in this thesis and include
a vulnerability's access vector and impact type.
\TUsubsubsection{Access vector}
The access vector of a vulnerability on NVD refers to the logical location from
which the attacker may launch the attack. The possible attack vectors according
to the National Vulnerability Database are as follows.
\begin{description}
\item[Local] The vulnerability is exploitable through physical or local account access
    to the device on which the vulnerability resides.
\item[Adjacent Network] The vulnerability is exploitable through access to a network
    that is adjacent to the vulnerable host; that is, the attacker must be in the same
    broadcast domain or collision domain (e.g. the same network segment or VLAN).
\item[Network] No local or adjacent access is required to exploit the vulnerability;
    in other words, it is exploitable over the Internet.
\end{description}
\TUsubsubsection{Impact Type}
The vulnerability's impact type on NVD places the effects of the vulnerability's
exploitation on the target into one of the following categories.
, and another for some other type of privileged access.
\begin{description}
\item[Confidentiality] Confidentiality impacts allow the unauthorized disclosure 
    of information (corresponding to STRIDE's ``information disclosure'')
\item[Integrity] Allows modification of data (corresponding to STRIDE's ``tampering'')
\item[Availability] Availability impacts correspond to disruptions of service (STRIDE's
    ``denial of service'')
\item[Security Protection] The security protection category refers to the effects
    of exploits that provide unauthorized access to the target. This may be either
    general system access or application access. The security protection category
    corresponds roughly to STRIDE's ``elevation of privileges'' and also partly encompasses
    ``spoofing identity''. It has three subcategories:
    \begin{description}
    \item[User access] This subcategory refers to the attacker's gaining user level access
        to the operating system.
    \item[Administrative access] This subcategory refers to the attacker's gaining root level
        access to the operating system.
    \item[Other access] This subcategory refers to any other type of privileged access on
        the target.
    \end{description}
\end{description}
\TUsubsection{Topologies}
Introduction of actual terms begins with topologies, but first a note about the modeling
of adversaries is needed. 

Two approaches are possible for modeling the attacker. The first
is to design the network model so that it is, in a way, from the attacker's perspective.
In this scheme, henceforth the \emph{first person} strategy, the attacker is treated as
implicit, and its access and connections are considered properties of the system itself.
The adversary's access level to a server, for instance, would be modeled as a quality of
that server asset.

In the second approach, henceforth the \emph{third person} strategy, the attacker is
modeled as a first class part of the system: as an asset. Its properties, connections,
and access levels are modeled as qualities and topologies of the adversary asset.
This strategy, which is the one employed primarily in this thesis, can model multiple
adversaries. Aside from that difference, they are roughly equivalent and a matter
of taste on behalf of the modeler and analyst. This section's terminology, however,
assumes the third person model.

Two types of topology terms are introduced in this section: connection and access. These
correspond directly to the two NVD concepts introduced in the previous section.
\TUsubsubsection{Connection Topologies}
Connection topologies refer to how two assets are connected, over the network or otherwise.
They may be local, adjacent, or network connected. These connection topologies begin with
the word \texttt{connected}, followed by an underscore, then one of the three connection
types: \texttt{local}, \texttt{adjacent}, or \texttt{network}. For local and adjacent
connections, this is all that is necessary. 

For network connections it is
necessary to specify the available protocols individually. These are done by appending another
underscore, then the lower case version of the standard abbreviation for the protocol
(e.g. \texttt{connected\_network\_http} for web or \texttt{connected\_network\_ssh} for
secure shell).

Connections are one-way: the source of the connection topology is considered to be the
``client'' in the relationship, and the destination of the connection is considered
the ``server'', where such distinctions are meaningful.
\TUsubsubsection{Access Topologies}
Access topologies refer to trust relationships and distinguish what kind of access one
asset (possibly a program, individual, attacker, user, or other security principal) has
to another. Much like the subcategories of the Security Protection impact type,
there are three basic types of access topology (plus the lack of a topology, which
signifies a lack of any noteworthy trust or access relationship): user access,
root access, and other access.

They are named using the word \texttt{access}, followed by an underscore, followed
by the lowercase name of the access type, then, if the access type is \texttt{other},
an optional underscore delimited description of the access type (perhaps the name
of the application whose access level is in question). Examples include
\texttt{access\_user}, \texttt{access\_root}, \texttt{access\_other\_apache}, or
\texttt{access\_other\_vsftpd}.
\TUsubsection{Qualities}
Although qualities are used in a more \emph{ad hoc} fashion to describe entity-specific
asset properties, there is still a role for a few standard quality structures in the
lexicon, namely a simple ``status'' type of property to be used in determining
whether an asset is enabled or disabled.
\TUsubsubsection{Status}
The status property is simple but powerful. Each asset that represents a host has a
quality named \texttt{status}. It may take the value \texttt{up} or \texttt{down}.
This allows exploits against or involving the host in question to require that it
be online as a precondition, and it provides a simple mechanism of action for
denial of service attacks to be modeled -- they simply have the postcondition of
a \texttt{status = down} quality fact.

Later in this chapter, a simple preprocessor combined with a dash of syntactic sugar
is introduced to automate most of the status modeling process across both exploits
and the network model.

\TUsection{Syntactic Sugar}
\TUsubsection{Directional Topologies}
This section introduces a new notation for specification of topologies. As it
is common to model bidirectional topologies, an additional convenience syntax
is now permitted to specify the directionality of a topology. As before, 
topologies are specified by the word~\texttt{topology}, followed by a colon, 
followed by the names of the assets in question; however, in the new syntax,
they are separated not by a comma but by a directionality symbol:~\texttt{->} to 
represent a one-way topology from the left asset to the right asset,
or~\texttt{<->} to represent a two-way topology. To promote readability, there
is no~\texttt{<-} directionality permitted.

Furthermore, the model has no innate distinction between one-way and two-way
topologies except the \texttt{<->} shorthand for specifying symmetric topologies.
That is to say, a bidirectional topology fact is actually implemented as
two unidirectional topology facts. Therefore, for example, if a bidirectional
topology exists in the fact base, one of its component directional topologies may
be removed by the realization of an exploit without affecting its reverse.
\TUsubsection{Value Assignment}
In preparation for the introduction of real-valued facts, the existing discrete
type of qualities, henceforth called ``token valued'', are given a special
assignment operator. Simply put, token values are assigned with the~\texttt{=}
operator and tested with the~\texttt{=} and~\texttt{!=} operators. This
enables a robust distinction between assignment operators and relational
operators.

Additionally, \texttt{delete} operations in postconditions take only a quality
name, with no value required (eliminating the confusing possibility of a
command to \texttt{delete quality:a,q!=5}, one of several deletion commands
that has little meaning).
\TUsubsection{Host Declaration and Status Proprocessing}
To support the use of status properties of host assets, a set of shorthand
syntax is now provided for denoting which assets represent hosts. In practice,
this has been observed to be the majority of modeled assets, so the shorthand
is highly convenient for modelers. Host denotation and status processing is 
done in two places: in the declaration of assets, and in the parameter list of 
exploits.

In the asset list declaration, up hosts are denoted by prefixing their name with
the symbol~\texttt{@}, a signal to the host preprocessor to automatically add
the \texttt{quality:hostname,status=up} fact; and down hosts are denoted with
the~\texttt{!@} symbol, automatically adding the down host quality fact.

Similarly, in exploit parameter lists, asset parameters that must have the
up status precondition are declared by prefixing their names with the up host 
symbol~\texttt{@}; likewise with the down symbol~\texttt{!@}. If no host
status preconditions are required, no symbol is needed. The host status
preprocessor automatically adds the required preconditions; if a host status
postcondition is necessary, for example in the case of a denial of service
attack bringing a host offline, the status property must be manually specified;
this is not a significant burden, as this case arises considerably less
frequently.
\TUsubsection{Global and grouped exploits}
For a variety of modeling tasks, it is convenient to cause an exploit to be
fired on all possible bindings simultaneously or to synchronize two exploits'
firing with one another. Two optional keywords are now permitted at the beginning
of the exploit header for this purpose: \texttt{global} and \texttt{group()}.
The \texttt{group} keyword takes a single argument.

Their semantic behavior
is as follows. When a global exploit is fired on one binding of assets, it will
also be fired on all other assets for which a valid binding exists, and the
corresponding state transition will be considered a single edge on the attack
graph. When a group exploit is fired on a binding of assets, all other exploits
denoted with the group keyword and the same group argument will also attempt
to fire on the same asset binding. Obviously grouped exploits require the same
number of parameters.
\TUsubsection{Platform Properties}
Platform facts are new types of facts introduced by this work. They use the
specification used by MITRE's Common Platform Enumeration (CPE), a component
of the Security Content Automation Protocol (SCAP). (TODO: CITE)
They can specify operating systems, applications, and hardware.

A CPE platform fact simply a valid CPE URI tied to an asset. The CPE URI is
comprised of the word \texttt{cpe}, a 
colon, then a slash, then the part type (\texttt{o} for operating system, \texttt{a} for
application, or \texttt{h} for hardware), then a colon, then the CPE vendor abbreviation,
then a colon, then the CPE product abbreviation, a colon, the version, a colon, the update, a colon, 
the edition, a colon, then the language. Version is required, but the rest is optional.

For example, to specify that a host is running Adobe Reader version 8.1, a 
platform fact named \texttt{cpe:/a:adobe:reader:8.1} would be used. Platforms
are matched according to the algorithms provided in the CPE specification,
permitting blank (wildcard) fields and the prefix property.
\TUsection{Generation process changes}
% TODO
\TUsection{Examples}
\TUsubsection{Illustrative}
\TUsubsection{Blunderdome}
\TUsection{Analysis}
